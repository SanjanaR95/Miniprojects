# -*- coding: utf-8 -*-
"""Stock Price Prediction with Facebook Prophet Model.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1yWDfkbfMGWtp0TJrR0V3n3CP7lB_lRVL
"""

# Robust fbprophet shim → maps to the maintained 'prophet' package (Python 3.12 friendly)
import sys, types, importlib

# 1) Install/ensure 'prophet'
!pip -q install prophet

import prophet as _prophet

# 2) Build a shim module named 'fbprophet'
fbprophet = types.ModuleType("fbprophet")
setattr(fbprophet, "__version__", getattr(_prophet, "__version__", "shim"))

# Always expose Prophet class
fbprophet.Prophet = _prophet.Prophet

# 3) Try to mirror common submodules; create empty stubs if missing
def _get_or_stub(subname):
    # Try attribute on prophet
    sub = getattr(_prophet, subname, None)
    if sub is not None:
        return sub
    # Try import prophet.subname
    try:
        return importlib.import_module(f"prophet.{subname}")
    except Exception:
        # Create an empty stub module so imports like `from fbprophet import serialize` don't fail
        return types.ModuleType(f"fbprophet.{subname}")

for _name in ["forecaster", "plot", "diagnostics", "serialize"]:
    _sub = _get_or_stub(_name)
    setattr(fbprophet, _name, _sub)
    sys.modules[f"fbprophet.{_name}"] = _sub

# 4) Register the shim so `import fbprophet` (and submodules) works unchanged
sys.modules["fbprophet"] = fbprophet

print("✅ fbprophet shim active — using 'prophet' backend", getattr(_prophet, "__version__", ""))

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import pandas_datareader as web
import warnings
!pip install fbprophet
import fbprophet

import urllib.request, os

url = "https://raw.githubusercontent.com/amankharwal/Website-data/master/GOOG.csv"
outfile = "GOOG.csv"

urllib.request.urlretrieve(url, outfile)
print("Downloaded:", outfile, "-", os.path.getsize(outfile), "bytes")

from google.colab import files
uploaded = files.upload()
data = pd.read_csv("GOOG.csv")
data.head()

plt.style.use("fivethirtyeight")
plt.figure(figsize=(16,8))
plt.title("Google Closing Stock Price")
plt.plot(data["Close"])
plt.xlabel("Date", fontsize=18)
plt.ylabel("Close Price USD ($)", fontsize=18)
plt.show()

data = data[["Date","Close"]]
data = data.rename(columns = {"Date":"ds","Close":"y"})
data.head()

from fbprophet import Prophet
m = Prophet(daily_seasonality=True)
m.fit(data)

future = m.make_future_dataframe(periods=365)
predictions=m.predict(future)
m.plot(predictions)
plt.title("Prediction of GOOGLE Stock Price")
plt.xlabel("Date")
plt.ylabel("Closing Stock Price")
plt.show()

m.plot_components(predictions)
plt.show()